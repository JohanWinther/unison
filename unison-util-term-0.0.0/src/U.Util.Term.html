<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BlockArguments #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">U.Util.Term</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">execWriter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tell</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traverse_</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">F'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MatchCase</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pattern</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">U.Codebase.Term</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Term</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">U.Core.ABT</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ABT</span></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span id="local-6989586621679059177"><span id="local-6989586621679059179"><span id="local-6989586621679059180"><span id="local-6989586621679059181"><span id="local-6989586621679059182"><span id="local-6989586621679059183"><span id="local-6989586621679059184"><span id="local-6989586621679059185"><span class="annot"><a href="U.Util.Term.html#text"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679059185"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ABT.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term.F'</span></span><span> </span><span class="annot"><a href="#local-6989586621679059184"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059183"><span class="hs-identifier hs-type">termRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059182"><span class="hs-identifier hs-type">typeRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059181"><span class="hs-identifier hs-type">termLink</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059180"><span class="hs-identifier hs-type">typeLink</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059179"><span class="hs-identifier hs-type">vt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059177"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059184"><span class="hs-identifier hs-type">text</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-15"></span><span id="text"><span class="annot"><span class="annottext">text :: forall v text termRef typeRef termLink typeLink vt a.
Ord v =&gt;
Term (F' text termRef typeRef termLink typeLink vt) v a -&gt; [text]
</span><a href="U.Util.Term.html#text"><span class="hs-identifier hs-var hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">execWriter</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) v a.
(Traversable f, Applicative g, Ord v) =&gt;
(f (Term f v a) -&gt; g ()) -&gt; Term f v a -&gt; g (Term f v a)
</span><span class="hs-identifier hs-var">ABT.visit_</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span id="local-6989586621679059056"><span class="annot"><span class="annottext">text
</span><a href="#local-6989586621679059056"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">text
</span><a href="#local-6989586621679059056"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="annottext">F'
  text
  termRef
  typeRef
  termLink
  typeLink
  vt
  (Term (F' text termRef typeRef termLink typeLink vt) v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span id="local-6989586621679059132"><span id="local-6989586621679059133"><span id="local-6989586621679059134"><span id="local-6989586621679059135"><span id="local-6989586621679059136"><span id="local-6989586621679059137"><span id="local-6989586621679059138"><span id="local-6989586621679059139"><span class="annot"><a href="U.Util.Term.html#dependencies"><span class="hs-identifier hs-type">dependencies</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679059139"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ABT.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Term.F'</span></span><span> </span><span class="annot"><a href="#local-6989586621679059138"><span class="hs-identifier hs-type">text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059137"><span class="hs-identifier hs-type">termRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-type">typeRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059135"><span class="hs-identifier hs-type">termLink</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059134"><span class="hs-identifier hs-type">typeLink</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059133"><span class="hs-identifier hs-type">vt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679059139"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679059132"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059137"><span class="hs-identifier hs-type">termRef</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059136"><span class="hs-identifier hs-type">typeRef</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059135"><span class="hs-identifier hs-type">termLink</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679059134"><span class="hs-identifier hs-type">typeLink</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-24"></span><span id="dependencies"><span class="annot"><span class="annottext">dependencies :: forall v text termRef typeRef termLink typeLink vt a.
Ord v =&gt;
Term (F' text termRef typeRef termLink typeLink vt) v a
-&gt; ([termRef], [typeRef], [termLink], [typeLink])
</span><a href="U.Util.Term.html#dependencies"><span class="hs-identifier hs-var hs-var">dependencies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="annottext">forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">execWriter</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) (g :: * -&gt; *) v a.
(Traversable f, Applicative g, Ord v) =&gt;
(f (Term f v a) -&gt; g ()) -&gt; Term f v a -&gt; g (Term f v a)
</span><span class="hs-identifier hs-var">ABT.visit_</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Ref</span></span><span> </span><span id="local-6989586621679059011"><span class="annot"><span class="annottext">termRef
</span><a href="#local-6989586621679059011"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {f :: * -&gt; *} {a} {b} {c} {d} {m :: * -&gt; *}.
(MonadWriter (f a, b, c, d) m, Monoid b, Monoid c, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679059010"><span class="hs-identifier hs-var">termRef</span></a></span><span> </span><span class="annot"><span class="annottext">termRef
</span><a href="#local-6989586621679059011"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Constructor</span></span><span> </span><span id="local-6989586621679059008"><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679059008"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {f :: * -&gt; *} {a} {c} {d} {m :: * -&gt; *}.
(MonadWriter (a, f a, c, d) m, Monoid a, Monoid c, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">typeRef</span></a></span><span> </span><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679059008"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Request</span></span><span> </span><span id="local-6989586621679059005"><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679059005"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">ConstructorId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {f :: * -&gt; *} {a} {c} {d} {m :: * -&gt; *}.
(MonadWriter (a, f a, c, d) m, Monoid a, Monoid c, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">typeRef</span></a></span><span> </span><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679059005"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Match</span></span><span> </span><span class="annot"><span class="annottext">Term (F' text termRef typeRef termLink typeLink vt) v a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679059003"><span class="annot"><span class="annottext">[MatchCase
   text
   typeRef
   (Term (F' text termRef typeRef termLink typeLink vt) v a)]
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">cases</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[MatchCase
   text
   typeRef
   (Term (F' text termRef typeRef termLink typeLink vt) v a)]
</span><a href="#local-6989586621679059003"><span class="hs-identifier hs-var">cases</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-30"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">MatchCase</span></span><span> </span><span id="local-6989586621679059001"><span class="annot"><span class="annottext">Pattern text typeRef
</span><a href="#local-6989586621679059001"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679059000"><span class="annot"><span class="annottext">Maybe (Term (F' text termRef typeRef termLink typeLink vt) v a)
</span><a href="#local-6989586621679059000"><span class="hs-identifier hs-var">_guard</span></a></span></span><span> </span><span id="local-6989586621679058999"><span class="annot"><span class="annottext">Term (F' text termRef typeRef termLink typeLink vt) v a
</span><a href="#local-6989586621679058999"><span class="hs-identifier hs-var">_body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {t}.
Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern text typeRef
</span><a href="#local-6989586621679059001"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-31"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>          </span><span id="local-6989586621679058998"><span class="annot"><span class="annottext">go :: Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-33"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PConstructor</span></span><span> </span><span id="local-6989586621679058975"><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679058975"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679058974"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621679058974"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621679058973"><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {f :: * -&gt; *} {a} {c} {d} {m :: * -&gt; *}.
(MonadWriter (a, f a, c, d) m, Monoid a, Monoid c, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">typeRef</span></a></span><span> </span><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679058975"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058973"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-34"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PAs</span></span><span> </span><span id="local-6989586621679058971"><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058971"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058971"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-35"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PEffectPure</span></span><span> </span><span id="local-6989586621679058969"><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058969"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058969"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-36"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PEffectBind</span></span><span> </span><span id="local-6989586621679058967"><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679058967"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679058966"><span class="annot"><span class="annottext">ConstructorId
</span><a href="#local-6989586621679058966"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621679058965"><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058965"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679058964"><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058964"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {f :: * -&gt; *} {a} {c} {d} {m :: * -&gt; *}.
(MonadWriter (a, f a, c, d) m, Monoid a, Monoid c, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var">typeRef</span></a></span><span> </span><span class="annot"><span class="annottext">typeRef
</span><a href="#local-6989586621679058967"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058965"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058964"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-37"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PSequenceLiteral</span></span><span> </span><span id="local-6989586621679058962"><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">pats</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Pattern t typeRef]
</span><a href="#local-6989586621679058962"><span class="hs-identifier hs-var">pats</span></a></span><span>
</span><span id="line-38"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">PSequenceOp</span></span><span> </span><span id="local-6989586621679058960"><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058960"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679058959"><span class="annot"><span class="annottext">SeqOp
</span><a href="#local-6989586621679058959"><span class="hs-identifier hs-var">_op</span></a></span></span><span> </span><span id="local-6989586621679058958"><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058960"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
-&gt; WriterT
     ([termRef], [typeRef], [termLink], [typeLink]) Identity ()
</span><a href="#local-6989586621679058998"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><a href="#local-6989586621679058958"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-39"></span><span>            </span><span class="annot"><span class="annottext">Pattern t typeRef
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TermLink</span></span><span> </span><span id="local-6989586621679058956"><span class="annot"><span class="annottext">termLink
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {f :: * -&gt; *} {a} {d} {m :: * -&gt; *}.
(MonadWriter (a, b, f a, d) m, Monoid a, Monoid b, Monoid d,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var">termLink</span></a></span><span> </span><span class="annot"><span class="annottext">termLink
</span><a href="#local-6989586621679058956"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">TypeLink</span></span><span> </span><span id="local-6989586621679058953"><span class="annot"><span class="annottext">typeLink
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {c} {f :: * -&gt; *} {a} {m :: * -&gt; *}.
(MonadWriter (a, b, c, f a) m, Monoid a, Monoid b, Monoid c,
 Applicative f) =&gt;
a -&gt; m ()
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var">typeLink</span></a></span><span> </span><span class="annot"><span class="annottext">typeLink
</span><a href="#local-6989586621679058953"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="annottext">F'
  text
  termRef
  typeRef
  termLink
  typeLink
  vt
  (Term (F' text termRef typeRef termLink typeLink vt) v a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>    </span><span id="local-6989586621679059010"><span class="annot"><span class="annottext">termRef :: a -&gt; m ()
</span><a href="#local-6989586621679059010"><span class="hs-identifier hs-var hs-var">termRef</span></a></span></span><span> </span><span id="local-6989586621679058941"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058941"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058941"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span id="local-6989586621679059007"><span class="annot"><span class="annottext">typeRef :: a -&gt; m ()
</span><a href="#local-6989586621679059007"><span class="hs-identifier hs-var hs-var">typeRef</span></a></span></span><span> </span><span id="local-6989586621679058930"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058930"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058930"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span id="local-6989586621679058955"><span class="annot"><span class="annottext">termLink :: a -&gt; m ()
</span><a href="#local-6989586621679058955"><span class="hs-identifier hs-var hs-var">termLink</span></a></span></span><span> </span><span id="local-6989586621679058919"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058919"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058919"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span id="local-6989586621679058952"><span class="annot"><span class="annottext">typeLink :: a -&gt; m ()
</span><a href="#local-6989586621679058952"><span class="hs-identifier hs-var hs-var">typeLink</span></a></span></span><span> </span><span id="local-6989586621679058908"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058908"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679058908"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span></pre></body></html>